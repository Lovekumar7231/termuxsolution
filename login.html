<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Login</title>
    <link rel="stylesheet" href="style.css">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
       (function(){ emailjs.init("ijs5TFBMM18XzlFac"); })();
    </script>
</head>
<body>

<div class="auth-box" style="margin-top:100px;">
    <h2 class="glitch">SYSTEM ACCESS</h2>

    <div id="login-form">
        <input type="text" id="loginUser" placeholder="Codename (Use 'Admin' for Admin)">
        <input type="password" id="loginPass" placeholder="Password">
        <button class="btn-main" onclick="handleLogin()">EXECUTE LOGIN</button>
    </div>

    <div id="otp-form" style="display:none;">
        <p style="color:gold;">⚠️ ADMIN DETECTED. OTP SENT.</p>
        <input type="number" id="adminOtp" placeholder="Enter OTP Code">
        <button class="btn-gold" onclick="verifyAdminOtp()">VERIFY & UNLOCK</button>
    </div>

    <div style="margin-top:20px;">
        <a href="signup.html" style="color:white;">Create Account</a>
    </div>
</div>

<script>
    let generatedOtp = 0;

    function handleLogin() {
        const user = document.getElementById('loginUser').value;
        const pass = document.getElementById('loginPass').value;

        // 1. ADMIN CHECK
        if (user === "Admin" && pass === "Love@728296#$") {
            generatedOtp = Math.floor(1000 + Math.random() * 9000);
            
            // EmailJS Send
            emailjs.send("service_idclxul", "template_6sk2up1", {
                to_email: "admin@gmail.com", // APNA EMAIL DALEN
                name: "Admin",
                otp_code: generatedOtp
            }).then(() => {
                alert("✅ OTP Sent to Admin Email!");
                document.getElementById('login-form').style.display = 'none';
                document.getElementById('otp-form').style.display = 'block';
            });
            return;
        }

        // 2. NORMAL USER (Simulation)
        if(user) {
            localStorage.setItem("agentName", user);
            localStorage.setItem("isAdmin", "false");
            window.location.href = "index.html";
        } else {
            alert("Username required!");
        }
    }

    function verifyAdminOtp() {
        if(document.getElementById('adminOtp').value == generatedOtp) {
            localStorage.setItem("agentName", "COMMANDER");
            localStorage.setItem("isAdmin", "true");
            window.location.href = "index.html";
        } else {
            alert("❌ WRONG OTP");
        }
    }
</script>

</body>
</html>

