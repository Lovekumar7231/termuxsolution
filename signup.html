<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join The Army</title>
    <link rel="stylesheet" href="auth-style.css">
    
    <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js">
    </script>
    
    <script type="text/javascript">
       (function(){
          emailjs.init("ijs5TFBMM18XzlFac");
       })();
    </script>
</head>
<body>

<div class="auth-box">
    <h2 id="signupTitle" class="glitch">Join The Army</h2>

    <div class="input-group">
        <label>CODENAME (USERNAME)</label>
        <input type="text" id="username" placeholder="Choose Codename">
    </div>

    <div class="input-group">
        <label>ENCRYPTED MAIL (EMAIL)</label>
        <input type="email" id="email" placeholder="email@example.com">
    </div>

    <div class="input-group">
        <label>ACCESS KEY (PASSWORD)</label>
        <input type="password" id="password" placeholder="Create Password">
    </div>

    <button id="otpBtn" onclick="sendRealOTP()">
        Send Verification Code
    </button>
    
    <div class="input-group">
        <label>EMAIL VERIFICATION CODE</label>
        <input type="text" id="enteredOtp" placeholder="Enter OTP from Email">
    </div>

    <button onclick="verifyOTP()">
        Verify & Signup
    </button>

    <div class="auth-links">
        Already an agent? <a href="login.html">Login Here</a>
    </div>
</div>

<script>
    let actualOTP = 0;

    function sendRealOTP() {
        const email = document.getElementById("email").value;
        const name = document.getElementById("username").value;
        const pass = document.getElementById("password").value;
        const btn = document.getElementById("otpBtn");

        if (!email || !name || !pass) {
            alert("‚ö†Ô∏è Error: Fill all fields first!");
            return;
        }

        btn.innerText = "Sending Email...";
        actualOTP = Math.floor(1000 + Math.random() * 9000);

        const emailParams = {
            name: name,
            otp_code: actualOTP,
            to_email: email
        };

        emailjs.send("service_idclxul", "template_6sk2up1", emailParams)
            .then(function(response) {
                alert("‚úÖ OTP Sent to " + email);
                btn.innerText = "Resend OTP";
            }, function(error) {
                alert("‚ùå Failed. Error: " + JSON.stringify(error));
                btn.innerText = "Send Verification Code";
            });
    }

    function verifyOTP() {
        const userOtp = document.getElementById("enteredOtp").value;
        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;
        
        if (userOtp == actualOTP && actualOTP !== 0) {
            // üëá ‡§Ø‡§π‡§æ‡§Å ‡§°‡•á‡§ü‡§æ Save ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à (‡§ú‡§æ‡§¶‡•Ç)
            localStorage.setItem("agentName", username);
            localStorage.setItem("agentPass", password);
            
            alert("üîì Account Created! Login credentials saved.");
            window.location.href = "login.html";
        } else {
            alert("üö´ Wrong OTP!");
        }
    }
</script>

</body>
</html>

